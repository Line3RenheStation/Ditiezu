<!doctype html>
<html lang="zh-CN zh">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>Thread Display</title>
    <link href="./styles.css" rel="stylesheet">
    <script src="main.js"></script>
</head>
<body>
<div id='content'></div>
</body>
<script>
    window.darkMode = (type) => {
        if (type)
            document.body.classList.add("darkmode");
        else
            document.body.classList.remove("darkmode");
    };
    window.onload = () => {
        let page = new DOMParser().parseFromString(android.getLoadedPage(), "text/html").children[0];
        let container = $("#content")[0]
        page.$("[id^='pid']").forEach(reply => {
            let replyThreadContainer = container.appendNewChild({type: "div", attr: [["class", "threadContainer"]]});
            replyThreadContainer.appendNewChild({
                type: "img",
                attr: [["class", "threadMeta_AuthorAvatar"], ["src", reply.$(".avatar img")[0].src], ["onerror", "this.src='noavatar_middle.jpg';"]]
            });
            replyThreadContainer.appendNewChild({
                type: "div",
                attr: [["class", "threadMeta_Container"]],
                innerHTML: `<p class="threadMeta_AuthorName">${reply.$('.pi .authi a')[0].innerText}</p><p class="threadMeta_PostMeta">${reply.$("p em")[0].innerText} · ${reply.$(".pi strong")[0].innerText} · ${reply.$('.pi [id^="authorposton"]')[0].innerText}</p>`
            });
            replyThreadContainer.appendNewChild({
                type: "div",
                attr: [["class", "threadContent"]],
                innerHTML: reply.$(".t_fsz")[0].innerHTML
            });
        });
        darkMode(android.isDarkMode());
    };
</script>
</html>